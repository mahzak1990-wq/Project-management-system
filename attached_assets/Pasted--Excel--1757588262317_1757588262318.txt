لمشكلة المختصرة:
بعد تصدير/استيراد ملف Excel من قائمة الإعدادات، تظهر جداول متابعة الموارد (الشهري والأسبوعي) في التطبيق فارغة رغم وجود بيانات في شيت الإكسل. (مرفق لقطات شاشة توضح المناطق الفارغة والمظلّلة).

التوقعات الفنية (كيف يجب أن يعمل الربط)

الورقة الخاصة بالمشروع: يتم الانتقال إليها بحسب كود المشروع الموجود في الخلية E3.

الجدول الأسبوعي:

تطابق أعمدة التواريخ في الشيت مع التاريخ الموجود في الصف رقم 17.

إذا لم يُعثر على التاريخ نفسه، يتم المطابقة مع أقرب تاريخ تالٍ أو سابق.

بعد تحديد العمود: تُؤخذ بيانات العمالة المخططة من الصف 18، والمعدات المخططة من الصف 19.

نطاق الأعمدة الذي يؤخذ منه البيانات: من العمود B حتى نهاية الأعمدة المحتوية على بيانات.

تعرض القيم في التطبيق داخل جدول "العمالة الأسبوعية".

الجدول الشهري:

تُطابق قيمة التاريخ الشهري بالبرنامج مع التاريخ في الصف 20 بشيت الإكسل مع إهمال اليوم (أي: المطابقة على مستوى الشهر فقط).

بعد المطابقة: تُؤخذ بيانات العمالة من الصف 21، والمعدات من الصف 22.

السلوك الحالي الملاحظ

الجدولين (الشهري والأسبوعي) يظهران خاليين (قِيم فارغة) داخل التطبيق بعد التصدير/الاستيراد، بالرغم من وجود بيانات في الشيت في الصفوف المشار إليها. (انظر لقطات الشاشة المرفقة — أماكن الجدول المظللة فارغة).

نقاط فحص مقترحة — أرجو التحقق منها من فضلكم

نوع وصيغة التواريخ في شيت الإكسل:

هل رؤوس التواريخ عبارة عن قيم تاريخ فعلية (Excel Date) أم نص (string)؟

هل صيغة التاريخ متوافقة مع Locale (مثلاً dd-mm-yyyy vs mm/dd/yyyy vs MMM YYYY)؟

موقع رؤوس التواريخ والصفوف المتوقعة:

هل صف الرأس الذي يحتوي التواريخ فعلاً يبدأ عند الصف 17 أم تم إدراج/حذف صفوف فغيّرت الإزاحة؟

هل الصفوف 17–22 موجودة وغير مدمجة أو مخفية؟

الخلايا المدمجة (Merged Cells):

هل هناك خلايا مدمجة في صف الرؤوس أو الصفوف 17–22؟ المدمجات قد تكسر محاذاة الأعمدة.

التسميات وأسماء أوراق العمل (Sheet names):

هل اسم ورقة المشروع يتطابق تمامًا مع ما يقرأه التطبيق بناءً على خلية E3 (مسافات زائدة أو اختلافات في الحروف قد تمنع الوصول)?

خلايا فارغة أو صيغ تعطي خطأ:

هل القيم تحت الأعمدة عبارة عن صيغ تُعيد قيمة فارغة أو خطأ؟

أعمدة مخفية/فلتر فعال:

هل هناك أعمدة مخفية أو فلتر يمنع رؤيتها؟

مسافات/حروف غريبة:

تأكد من عدم وجود مسافات بادئة أو أحرف غير مرئية في رؤوس التاريخ أو في أسماء الصفوف.

صلاحيات الوصول / حماية الورقة:

هل الورقة محمية أو مؤمنة بحيث يمنع البرنامج القراءة؟

المنطق الخاص بالمطابقة (Exact vs Nearest):

تأكدوا من أن المنطق المُطبق للمطابقة (مثلاً اختيار "الأقرب") يعمل بناءً على ترتيب التواريخ الصحيح ضمن الشيت وليس كنصوص غير قابلة للفرز.

لغة/Local التواريخ:

في حال كانت رؤوس الشهور باللغة العربية أو بصيغة اسم شهر (مثل "مايو 2025")، هل البرنامج يتعرف على نفس الصيغة؟

طلبات وإجراءات مقترحة من فريق Replit

التحقق من سجلات (logs) أثناء الاستيراد/التصدير لأخطاء متعلقة بقراءة الشيت (مثل: "sheet not found", "date parse error", "empty row", إلخ).

التحقق أن التطبيق يحاول الوصول إلى الصفوف 17–22 والأعمدة من B إلى النهاية بالفعل عند المعالجة.

تجربة ملف Excel تجريبي بسيط (ملف يحتوي فقط على ورقة مشروع واحدة مع رؤوس تواريخ صحيحة وبيانات في الصفوف 17–22) للتأكد من أن الميكانيكا تعمل في أبسط حالة.

إذا ظهر خطأ في التحويل/المطابقة، الرجاء تزويدي برسائل الخطأ أو لقطات من الـ logs حتى أتمكن من إرسالها لكم أو مشاركتها مع الفريق.

في حال تطلب الأمر، أستطيع إرسال نسخة مصغّرة من ملف الإكسل (مؤمن/مُجهّل إن احتجتم) لتجربته عندكم.

أمثلة متوقعة (للمقارنة)

عند وجود عمود بتاريخ 10-07-2025 وعمود آخر 17-07-2025، وإذا طلب البرنامج تاريخ 12-07-2025، فيجب أن يطابق الأقرب (أي 10-07 أو 17-07 بحسب من هو الأقرب زمنياً) ويأخذ القيم من صف 18 و19 لنفس العمود.

عند طلب "مايو 2025" في الجدول الشهري، يجب أن يطابق أي خلية في صف 20 تحمل تاريخًا يقع ضمن شهر مايو 2025 (مع إهمال اليوم).