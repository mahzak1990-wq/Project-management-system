فحوصات سريعة (يُنفّذها فوراً)

تأكيد مصدر الملف: تأكدوا أن الواجهة تقرأ آخر نسخة من ملف الإكسل/المصدر وأن الخدمة تملك صلاحية قراءة الملف. أرسلوا لنا وقت وتاريخ آخر تعديل (Last Modified) للملف للتحقق.

سحب صفوف المرجع: استخرجوا (Export) محتويات الصفوف رقم 17,18,19,20,21,22 لكل مشروع وتزويدنا بعينة.

تحقق من الفراغات/رموز بدل القيم: راجعوا تلك الصفوف بحثاً عن قيم مثل - أو — أو نصوص غير رقمية أو تواريخ مخزنة كنـ"نص".

تسجيل الأخطاء (Logs): شغّلوا التحميل وأحضروا أي رسائل خطأ أو تسجيلات (backend logs / frontend console).

2) الإصلاحات السريعة (يمكن تنفيذها خلال ساعة)

تطهير القيم (Cleaning): استبدال رموز مثل - أو — بقيمة صالحة (0 أو فراغ منطقي)؛ إزالة مسافات زائدة حول النصوص؛ تحويل تواريخ مخزنة كنص إلى نوع تاريخ.

فرض نوع البيانات: عند القراءة تأكدوا أن أعمدة العمالة والمعدات تُعامل كأرقام وأن صفوف التواريخ تُعامل كتواريخ. إذا وجدتم نصوص لا تقبل التحويل، سجلوا أماكنها وأرسلوها.

التأكد من قراءة الصفوف الصحيحة: حققوا أن النظام يستخرج القيم من الصفوف 17..22 (وليس أرقام صفوف أخرى أو رؤوس متغيرة). إن كان الربط يعتمد على أرقام صف ثابتة فجرّبوا مؤقتاً الربط اليدوي على عيّنة مشروع للتأكد.

تعطيل الـ cache مؤقتاً: اجعلوا الواجهة تقرأ الملف مباشرةً (bypass cache) بعد رفعه للتأكد أن التغيير ينعكس فوراً.

3) حلول منطقية لتطابق التواريخ (القاعدة المطلوبة)

المطلوب: إذا لم يوجد تاريخ يوم الخميس في صف التواريخ الأسبوعي (صف 17) المطابق للأسبوع المستهدف، يتم اختيار أقرب تاريخ يسبقه أو يليه.

طريقة العمل المفهومة دون كود:

احسب تاريخ هدف الأسبوع (مثلاً تاريخ يوم الخميس لذلك الأسبوع).

قارن هذا التاريخ مع جميع التواريخ الموجودة في صف 17.

اختر التاريخ الذي يقلل الفارق المطلق بالأيام بينه وبين تاريخ الهدف (بمعنى — التاريخ الأقرب زمنياً).

حالة التعادل (إذا كان هناك تاريخان يبعدان نفس المسافة): اتفقوا على قاعدة اختيار واحدة — أفضل اقتراح عملي: اختروا التاريخ اللاحق (الأقرب بعده) لأنّه عادة يعكس الجدولة الأحدث؛ لكن يمكن الاتفاق على اختيار السابق إذا كان ذلك منطقيّاً لأعمالكم.

سجلوا حالة المطابقة: إن لم يكن التاريخ مطابقًا تمامًا، يجب أن يظهر سجل (log) يبيّن أن الواجهة استخدمت تاريخاً بديلاً وأن يوضح الفارق بالأيام.

4) تحسين الربط والمرونة (حلول متوسطة وطويلة المدى)

تجنّب الاعتماد على أرقام صف ثابتة: استخدموا ربطاً يعتمد على مسميات موحّدة أو Named Ranges أو جدول (Excel Table) بحيث لا تؤثر إضافة/حذف صفوف على الموقع.

اعتماد أسماء حقول معيارية: ضعوا قاموس مطابقة للأسماء (مثلاً "عدد العمالة" قد تكتب بأشكال مختلفة) ليتعرّف النظام على المسمى بمرونة (synonyms).

وحدة تنظيف مركزية: قبل تمرير البيانات للعرض، مررواها عبر خطوة تنظيف موحّدة (تحويل نص إلى رقم/تاريخ، استبدال رموز، ملء فراغات).

تحسين مخرجات الأخطاء للواجهة: عرض رسالة قصيرة للمستخدم عند غياب بيانات مع زر "تفاصيل الخطأ" يفتح لوج يظهر سبب الغياب (مثلاً: صف 21 فارغ / تاريخ الخميس غير موجود — استخدمنا 2024-08-08 بدلاً من 2024-08-15).

5) سياسات عرض البيانات في الواجهة (UX)

عرض بدائل واضحة: إذا استخدم النظام تاريخ بديل أظهروا أيقونة صغيرة أو نصاً (مثلاً: “اختير تاريخ بديل: 2024-08-08 — الفرق 7 أيام”).

عرض قيّم افتراضية: إن لم يتوفر رقم عُمّال أو معدات، عرضوا صفر مع توضيح بالألوان (مثلاً رمادي مع tooltip يشرح السبب).

زر إعادة تحميل/تحديث: لمنع مشاكل الكاش، اجعلوا لدى المستخدم خيار "تحديث من المصدر الآن" يظهر آخر وقت تحميل.

6) قواعد تحقق (Validation Rules) يجب تطبيقها قبل العرض

لكل خلية بالعُمّال/المعدّات: هل القيمة رقم؟ إن لم تكن، اعتبروها خطأ ودوّنو الموقع.

لصفوف التواريخ: هل كل خلية تحتوي على تاريخ صالح؟ إن لم يكن كذلك، حددوها كـ "غير صالحة" واستخدموا أقرب تاريخ صالح.

تأكيد تطابق الأعمدة: عدد الأعمدة/التواريخ في صف 17 أو 20 يجب أن يتوافق مع عدد الأعمدة المراد عرضها في الجدول. إن اختلف العدد — سجّلوا وأظهروا رسالة.

7) اختبار (Manual QA) — قائمة حالات للاختبار قبل الإطلاق

اختبروا كل حالة مع مشروع نموذجي وتوثيق النتيجة:

تاريخ الخميس موجود بالضبط في صف 17 → يجب أن يُستخدم مباشرة.

تاريخ الخميس غير موجود، وهناك تاريخ سابق فقط → يجب اختيار الأقرب.

تاريخ الخميس غير موجود، وهناك تاريخ لاحق فقط → اختر الأقرب لاحقاً.

تاريخان متساويان البُعد → طبقوا قاعدة التعادل (اختر لاحقاً أو سابقاً حسب الاتفاق).

صف 21 أو 22 فارغ → الواجهة تعرض تحذيراً وتستخدم 0 أو placeholder.

تواريخ مخزنة كنـنص → النظام يحوّلها ويعرضها أو يعرّفها كخطأ إذا غير قابلة للتحويل.

تغيّر في ملف المصدر → بعد التحديث يجب أن ينعكس في الواجهة فوراً بعد الضغط على "تحديث".

8) تسجيل ومراقبة (Monitoring)

سجّل تحذيرات عند كل مرة تُستخدم فيها قاعدة البديل (closest-date) مع تفاصيل: مشروع، التاريخ المطلوب، التاريخ المختار، الفرق بالأيام.

إنشاء تنبيه إذا تجاوز عدد التحذيرات نسبة معينة (مثلاً >10% من الأسابيع) ليشير إلى وجود مشكلة في مصدر البيانات.

لوحة حالة (dashboard) صغيرة تعرض نسبة نجاح قراءات الصفوف 17..22، وأحدث الأخطاء.

9) رسالة جاهزة لمراسلة ريبليت (انسخواها وأرسلوها لهم)

مرحباً فريق ريبليت،
بعد فحص الواجهة وملف المصدر تبيّن أن البيانات لا تعرض لعدة أسباب محتملة. نرجو تطبيق الخطوات التالية بالترتيب وإعلامنا بعد التنفيذ مع لوج التحميل:

تنفيذ الفحوص السريعة: استخراج الصفوف 17..22 وإرسال عينة لنا، وإرسال أي رسائل خطأ من الواجهة.

تطهير البيانات فوراً: استبدال رموز مثل "-"، إزالة مسافات، وتحويل النصوص إلى أرقام/تواريخ.

فرض أنواع البيانات: تأكيد أن العمالة/المعدات أرقام والتواريخ تواريخ قبل العرض.

تطبيق منطق أقرب تاريخ في الجدول الأسبوعي: إذا لم يوجد تاريخ الخميس المطابق في صف 17، يلزم اختيار التاريخ الأقرب زمنياً (في حالة التعادل اختر التاريخ اللاحق). سجّلوا كل حالة استخدام لهذا البديل.

تعطيل الكاش مؤقتاً أو إضافة زر "تحديث من المصدر" حتى نتأكّد من انعكاس التغييرات فورياً.

إضافة لوج واضح يظهر سبب غياب أو بدائل البيانات (مثال: صف 21 فارغ أو استخدمنا تاريخ بديل).

بعد تطبيق الخطوات الرجاء تزويدنا بتقرير اختبار يضم حالات الاختبار المذكورة أعلاه ونتائجها.
شكراً — ننتظر نتائج الفحص والتقرير للمتابعة.

10) معايير قبول نهائية (Acceptance Criteria)

الجدولين (شهري وأسبوعي) يعرضان أرقام العمالة والمعدات لكل مشروع دون فراغات غير مبررة.

عند عدم تطابق تاريخ الخميس، يتم اختيار أقرب تاريخ ويُسجل هذا الحدث في اللوج، والواجهة تعرض توضيحاً للمستخدم.

أي قيمة غير صالحة تظهر كتحذير في اللوج وليس كقيمة خاطئة في الواجهة.

التحديث من الملف يُنعكس فوراً بعد الضغط على تحديث أو رفع ملف جديد (لا يعتمد على كاش قديم).